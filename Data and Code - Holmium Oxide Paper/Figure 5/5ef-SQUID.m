%% Settings for plotting
RedAccent =[229/255,20/255,0/255];
BlueAccent =[76/255,174/255,227/255];
GreenAccent =[51/255,153/255,51/255];
White=[1 1 1];
Black=[0 0 0];
DefaultBlue=[0    0.4470    0.7410];
DefaultOrange=[0.8500    0.3250    0.0980];
DefaultYellow=[0.9290    0.6940    0.1250];
DefaultPurple=[0.4940    0.1840    0.5560];
DefaultGreen=[0.4660    0.6740    0.1880];
DefaultLightBlue=[0.3010    0.7450    0.9330];
DefaultCrimson=[0.6350    0.0780    0.1840];
MarkerSize=7;
LineWidth=2.5;
PlotLineWidth=3;
MarkerLineWidth=2;
sz = 49;

%% Data imports - O2 plasma treatment
fieldOeO2 = [7.00E+04 6.50E+04 6.00E+04 5.50E+04 5.00E+04 4.50E+04 4.00E+04 3.50E+04 3.00E+04 2.50E+04 2.00E+04 2.00E+04 1.75E+04 1.50E+04 1.25E+04 1.00E+04 7.50E+03 5.00E+03 5.00E+03 4.00E+03 3.00E+03 2.00E+03 1.00E+03 0.00E+00 0.00E+00 -1.00E+03 -2.00E+03 -3.00E+03 -4.00E+03 -5.00E+03 -5.00E+03 -7.50E+03 -1.00E+04 -1.25E+04 -1.50E+04 -1.75E+04 -2.00E+04 -2.00E+04 -2.50E+04 -3.00E+04 -3.50E+04 -4.00E+04 -4.50E+04 -5.00E+04 -5.50E+04 -6.00E+04 -6.50E+04 -7.00E+04 -7.00E+04 -6.50E+04 -6.00E+04 -5.50E+04 -5.00E+04 -4.50E+04 -4.00E+04 -3.50E+04 -3.00E+04 -2.50E+04 -2.00E+04 -2.00E+04 -1.75E+04 -1.50E+04 -1.25E+04 -1.00E+04 -7.50E+03 -5.00E+03 -5.00E+03 -4.00E+03 -3.00E+03 -2.00E+03 -1.00E+03 0.00E+00 0.00E+00 1.00E+03 2.00E+03 3.00E+03 4.00E+03 5.00E+03 5.00E+03 7.50E+03 1.00E+04 1.25E+04 1.50E+04 1.75E+04 2.00E+04 2.00E+04 2.50E+04 3.00E+04 3.50E+04 4.00E+04 4.50E+04 5.00E+04 5.50E+04 6.00E+04 6.50E+04 7.00E+04];
fieldTO2 = fieldOeO2./10000;
emu_preO2 = [7.76E-03 7.73E-03 7.67E-03 7.62E-03 7.44E-03 7.33E-03 7.13E-03 6.89E-03 6.56E-03 6.13E-03 5.54E-03 5.56E-03 5.15E-03 4.70E-03 4.18E-03 3.57E-03 2.83E-03 1.97E-03 1.98E-03 1.61E-03 1.21E-03 8.14E-04 4.11E-04 -5.61E-06 -6.65E-06 -4.34E-04 -8.22E-04 -1.22E-03 -1.61E-03 -1.99E-03 -1.99E-03 -2.87E-03 -3.57E-03 -4.21E-03 -4.74E-03 -5.17E-03 -5.55E-03 -5.59E-03 -6.16E-03 -6.63E-03 -6.92E-03 -7.17E-03 -7.36E-03 -7.57E-03 -7.69E-03 -7.80E-03 -7.88E-03 -7.91E-03 -7.87E-03 -7.85E-03 -7.82E-03 -7.73E-03 -7.61E-03 -7.45E-03 -7.23E-03 -6.95E-03 -6.60E-03 -6.15E-03 -5.56E-03 -5.56E-03 -5.05E-03 -4.74E-03 -4.20E-03 -3.57E-03 -2.86E-03 -2.00E-03 -1.99E-03 -1.59E-03 -1.22E-03 -8.21E-04 -3.95E-04 6.14E-06 4.77E-06 4.10E-04 8.28E-04 1.22E-03 1.56E-03 1.99E-03 1.99E-03 2.85E-03 3.58E-03 4.20E-03 4.75E-03 5.17E-03 5.55E-03 5.55E-03 6.16E-03 6.60E-03 6.92E-03 7.16E-03 7.36E-03 7.50E-03 7.60E-03 7.73E-03 7.77E-03 7.82E-03];
emu_postO2 = [7.82E-03 7.78E-03 7.71E-03 7.62E-03 7.51E-03 7.60E-03 7.10E-03 6.95E-03 6.60E-03 6.16E-03 5.56E-03 5.56E-03 5.19E-03 4.74E-03 4.23E-03 3.60E-03 3.03E-03 1.99E-03 1.98E-03 1.58E-03 1.21E-03 8.23E-04 4.39E-04 -5.92E-06 -5.45E-06 -4.19E-04 -8.17E-04 -1.20E-03 -1.60E-03 -1.96E-03 -1.99E-03 -2.84E-03 -3.57E-03 -4.19E-03 -4.72E-03 -5.20E-03 -5.56E-03 -5.56E-03 -6.15E-03 -6.58E-03 -6.91E-03 -7.16E-03 -7.35E-03 -7.50E-03 -7.61E-03 -7.63E-03 -7.75E-03 -7.82E-03 -7.81E-03 -7.77E-03 -7.70E-03 -7.61E-03 -7.50E-03 -7.36E-03 -7.17E-03 -6.92E-03 -6.60E-03 -6.16E-03 -5.56E-03 -5.55E-03 -5.18E-03 -4.67E-03 -4.18E-03 -3.60E-03 -2.84E-03 -1.98E-03 -1.99E-03 -1.61E-03 -1.22E-03 -8.17E-04 -4.01E-04 5.29E-06 4.73E-06 4.20E-04 8.22E-04 1.22E-03 1.54E-03 1.95E-03 1.98E-03 2.84E-03 3.57E-03 4.19E-03 4.70E-03 5.18E-03 5.55E-03 5.55E-03 6.15E-03 6.59E-03 6.92E-03 7.16E-03 7.35E-03 7.49E-03 7.62E-03 7.69E-03 7.76E-03 7.81E-03];
% Normalization
c1 = max(emu_preO2);
emu_preO2 = emu_preO2/c1;
emu_postO2 = emu_postO2/c1;
%% Data imports - HF treatment
fieldOeHF = [0.00E+00 1.00E+03 2.00E+03 3.00E+03 4.00E+03 5.00E+03 5.00E+03 7.50E+03 1.00E+04 1.25E+04 1.50E+04 1.75E+04 2.00E+04 2.00E+04 2.50E+04 3.00E+04 3.50E+04 4.00E+04 4.50E+04 5.00E+04 5.50E+04 6.00E+04 6.50E+04 7.00E+04 7.00E+04 6.50E+04 6.00E+04 5.50E+04 5.00E+04 4.50E+04 4.00E+04 3.50E+04 3.00E+04 2.50E+04 2.00E+04 2.00E+04 1.75E+04 1.50E+04 1.25E+04 1.00E+04 7.50E+03 5.00E+03 5.00E+03 4.00E+03 3.00E+03 2.00E+03 1.00E+03 0.00E+00 0.00E+00 -1.00E+03 -2.00E+03 -3.00E+03 -4.00E+03 -5.00E+03 -5.00E+03 -7.50E+03 -1.00E+04 -1.25E+04 -1.50E+04 -1.75E+04 -2.00E+04 -2.00E+04 -2.50E+04 -3.00E+04 -3.50E+04 -4.00E+04 -4.50E+04 -5.00E+04 -5.50E+04 -6.00E+04 -6.50E+04 -7.00E+04 -7.00E+04 -6.50E+04 -6.00E+04 -5.50E+04 -5.00E+04 -4.50E+04 -4.00E+04 -3.50E+04 -3.00E+04 -2.50E+04 -2.00E+04 -2.00E+04 -1.75E+04 -1.50E+04 -1.25E+04 -1.00E+04 -7.50E+03 -5.00E+03 -5.00E+03 -4.00E+03 -3.00E+03 -2.00E+03 -1.00E+03 0.00E+00];
fieldTHF = fieldOeHF./10000;
emu_preHF = [3.93E-06 4.81E-04 9.51E-04 1.41E-03 1.85E-03 2.27E-03 2.27E-03 3.20E-03 3.98E-03 4.64E-03 5.19E-03 5.65E-03 5.94E-03 6.04E-03 6.63E-03 7.07E-03 7.40E-03 7.60E-03 7.83E-03 7.97E-03 8.08E-03 8.17E-03 8.22E-03 8.42E-03 8.47E-03 8.37E-03 8.30E-03 8.27E-03 8.10E-03 7.95E-03 7.76E-03 7.53E-03 7.19E-03 6.74E-03 6.13E-03 6.13E-03 5.67E-03 5.27E-03 4.71E-03 4.05E-03 3.25E-03 2.31E-03 2.30E-03 1.87E-03 1.43E-03 9.65E-04 4.88E-04 -5.81E-06 -5.98E-06 -4.95E-04 -9.70E-04 -1.43E-03 -1.88E-03 -2.30E-03 -2.30E-03 -3.25E-03 -4.04E-03 -4.71E-03 -5.27E-03 -5.74E-03 -6.13E-03 -6.13E-03 -6.74E-03 -7.18E-03 -7.51E-03 -7.75E-03 -7.94E-03 -8.15E-03 -8.21E-03 -8.30E-03 -8.36E-03 -8.43E-03 -8.44E-03 -8.37E-03 -8.30E-03 -8.21E-03 -8.09E-03 -8.05E-03 -7.76E-03 -7.50E-03 -7.16E-03 -6.79E-03 -6.12E-03 -6.11E-03 -5.72E-03 -5.26E-03 -4.70E-03 -4.04E-03 -3.24E-03 -2.29E-03 -2.29E-03 -1.87E-03 -1.43E-03 -9.63E-04 -4.80E-04 6.70E-06];
emu_postHF = [4.96E-06 4.80E-04 9.38E-04 1.40E-03 1.84E-03 2.25E-03 2.26E-03 3.18E-03 3.97E-03 4.66E-03 5.23E-03 5.71E-03 6.11E-03 6.12E-03 6.77E-03 7.26E-03 7.63E-03 7.92E-03 8.14E-03 8.32E-03 8.40E-03 8.47E-03 8.51E-03 8.51E-03 8.53E-03 8.53E-03 8.42E-03 8.30E-03 8.25E-03 8.10E-03 7.89E-03 7.60E-03 7.24E-03 6.76E-03 6.11E-03 6.09E-03 5.70E-03 5.23E-03 4.65E-03 3.98E-03 3.20E-03 2.27E-03 2.29E-03 1.85E-03 1.41E-03 9.59E-04 4.83E-04 -2.15E-06 -4.14E-06 -4.93E-04 -9.60E-04 -1.41E-03 -1.84E-03 -2.26E-03 -2.26E-03 -3.19E-03 -3.99E-03 -4.65E-03 -5.23E-03 -5.71E-03 -6.12E-03 -6.12E-03 -6.73E-03 -7.26E-03 -7.64E-03 -7.92E-03 -8.13E-03 -8.25E-03 -8.39E-03 -8.49E-03 -8.50E-03 -8.51E-03 -8.44E-03 -8.47E-03 -8.42E-03 -8.36E-03 -8.25E-03 -8.10E-03 -7.88E-03 -7.61E-03 -7.23E-03 -6.76E-03 -6.10E-03 -6.09E-03 -5.69E-03 -5.18E-03 -4.65E-03 -3.99E-03 -3.20E-03 -2.27E-03 -2.26E-03 -1.84E-03 -1.42E-03 -9.54E-04 -4.87E-04 -2.16E-07];
% Normalize
c2 = max(emu_preHF);
emu_preHF = emu_preHF/c2;
emu_postHF = emu_postHF/c2;

%% Plotting 
figure1 = figure;
subplot(1,2,1)
p1 = scatter(fieldTO2, emu_preO2, sz, 'o');
set(p1,'LineWidth',MarkerLineWidth,'MarkerFaceColor',DefaultBlue,'MarkerFaceAlpha',0,'MarkerEdgeAlpha',0.7);
box on
hold all
p2 = scatter(fieldTO2, emu_postO2, sz, '^');
set(p2,'LineWidth',PlotLineWidth,'MarkerFaceColor',DefaultOrange,'MarkerFaceAlpha',0,'MarkerEdgeAlpha',0.7);

xlim([-10 10]);
ylim([-1.2 1.2]);
set(gca,'FontSize',22,'LineWidth',LineWidth);
set(gca,'YTick',[-1 0 1])
set(gca,'XTick',[-5 0 5])
pbaspect([1.6 1 1])


fh = figure(1); % returns the handle to the figure object
set(fh, 'color', 'white'); % sets the color to white 
xlabel('\mu_0H (T)','Fontsize',22);
ylabel('M (a.u.)','Fontsize',22);

leg = legend('Pre-O_2 Plasma', 'Post-O_2 Plasma');
set(leg,'Location', 'northwest','Fontsize',22)
set(leg, 'Box', 'off')

subplot(1,2,2)
p1 = scatter(fieldTHF, emu_preHF, sz, 'o');
set(p1,'LineWidth',MarkerLineWidth,'MarkerFaceColor',DefaultBlue,'MarkerFaceAlpha',0,'MarkerEdgeAlpha',0.7);
box on
hold all
p2 = scatter(fieldTHF, emu_postHF, sz, '^');
set(p2,'LineWidth',PlotLineWidth,'MarkerFaceColor',DefaultOrange,'MarkerFaceAlpha',0,'MarkerEdgeAlpha',0.7);

xlim([-10 10]);
ylim([-1.2 1.2]);
set(gca,'FontSize',22,'LineWidth',LineWidth);
set(gca,'YTick',[-1 0 1])
set(gca,'XTick',[-5 0 5])
pbaspect([1.6 1 1])


fh = figure(1); % returns the handle to the figure object
set(fh, 'color', 'white'); % sets the color to white 
xlabel('\mu_0H (T)','Fontsize',22);
ylabel('M (a.u.)','Fontsize',22);

leg = legend('Pre-HF', 'Post-HF');
set(leg,'Location', 'northwest','Fontsize',22)
set(leg, 'Box', 'off')

% Export
fh = figure(1); % returns the handle to the figure object
set(fh, 'color', 'white'); % sets the color to white 
set(gcf, 'PaperPosition', [0 0 17 5.3]) % make paper larger
print(gcf, 'treatmentdraft.png', '-dpng', '-r300' ) % save 300 dpi file
